\hypertarget{amvp_8c}{\section{src/amvp.c File Reference}
\label{amvp_8c}\index{src/amvp.\-c@{src/amvp.\-c}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include \char`\"{}amvp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}amvp\-\_\-lcl.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}parson.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
const char $\ast$ \hyperlink{amvp_8c_aef9e6d5bd96d7f7a5355fa240147ad20}{amvp\-\_\-lookup\-\_\-test\-\_\-name} (A\-M\-V\-P\-\_\-\-T\-E\-S\-T test\-\_\-type)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_aef9e6d5bd96d7f7a5355fa240147ad20}{amvp\-\_\-lookup\-\_\-test\-\_\-name()} return an ascii string for a particular test. String is a const char and does not need to be freed. \end{DoxyCompactList}\item 
A\-M\-V\-P\-\_\-\-T\-E\-S\-T \hyperlink{amvp_8c_a3cfaee665578de7d947c74023e7d757f}{amvp\-\_\-lookup\-\_\-test\-\_\-type} (const char $\ast$test\-\_\-name)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a3cfaee665578de7d947c74023e7d757f}{amvp\-\_\-lookup\-\_\-test\-\_\-type()} return the A\-M\-V\-P\-\_\-\-T\-E\-S\-T enum for a particular test. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_af628c1972cfa1f74d56be6f4f5115baf}{amvp\-\_\-create\-\_\-test\-\_\-session} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$$\ast$ctx, \hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T}($\ast$progress\-\_\-cb)(char $\ast$msg))
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_af628c1972cfa1f74d56be6f4f5115baf}{amvp\-\_\-create\-\_\-test\-\_\-session()} creates a context that can be used to commence a test session with an A\-M\-V\-P server. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_a1cfaae59ace172c0698dddcc5146c2a6}{amvp\-\_\-free\-\_\-test\-\_\-session} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a1cfaae59ace172c0698dddcc5146c2a6}{amvp\-\_\-free\-\_\-test\-\_\-session()} releases the memory associated with an \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X}. \end{DoxyCompactList}\item 
\hypertarget{amvp_8c_a3cc16cee384335cda3c7952dacc567c5}{\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} {\bfseries amvp\-\_\-set\-\_\-test\-\_\-handler} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, const char $\ast$test\-\_\-name, A\-M\-V\-P\-\_\-\-T\-E\-S\-T\-\_\-\-H\-A\-N\-D\-L\-E\-R\-\_\-\-C\-A\-L\-L\-B\-A\-C\-K test\-\_\-handler)}\label{amvp_8c_a3cc16cee384335cda3c7952dacc567c5}

\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_aeb93f9081b6a5ead8747d25ebd7d59ce}{amvp\-\_\-does\-\_\-not\-\_\-apply} (\hyperlink{structamvp__tc__t}{A\-M\-V\-P\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} $\ast$tc, const char $\ast$info)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_aeb93f9081b6a5ead8747d25ebd7d59ce}{amvp\-\_\-does\-\_\-not\-\_\-apply()} Mark this test case as not applicable to the module under test. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_a900277f56b43928cf0872a80bdf2a116}{amvp\-\_\-not\-\_\-implemented} (\hyperlink{structamvp__tc__t}{A\-M\-V\-P\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} $\ast$tc)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a900277f56b43928cf0872a80bdf2a116}{amvp\-\_\-not\-\_\-implemented()} Mark this test case as not implemented. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_a3e2e0a8e39f1a1022dcdde62a4669a66}{amvp\-\_\-set\-\_\-vendor\-\_\-info} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, const char $\ast$vendor\-\_\-name, const char $\ast$vendor\-\_\-url, const char $\ast$contact\-\_\-name, const char $\ast$contact\-\_\-email)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a3e2e0a8e39f1a1022dcdde62a4669a66}{amvp\-\_\-set\-\_\-vendor\-\_\-info()} specifies the vendor attributes for the test session. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_a6c369c4e6f0e27051607e5bc00ea37cb}{amvp\-\_\-set\-\_\-module\-\_\-info} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, const char $\ast$module\-\_\-name, const char $\ast$module\-\_\-type, const char $\ast$module\-\_\-version, const char $\ast$module\-\_\-description)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a6c369c4e6f0e27051607e5bc00ea37cb}{amvp\-\_\-set\-\_\-module\-\_\-info()} specifies the crypto module attributes for the test session. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_a52516e04dceec62a7def9443dd28271e}{amvp\-\_\-set\-\_\-server} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, char $\ast$server\-\_\-name, int port)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a52516e04dceec62a7def9443dd28271e}{amvp\-\_\-set\-\_\-server()} specifies the A\-M\-V\-P server and T\-C\-P port number to use when contacting the server. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_ab2cc508cf1e3ec2dee379d401669de0f}{amvp\-\_\-set\-\_\-path\-\_\-segment} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, char $\ast$path\-\_\-segment)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_ab2cc508cf1e3ec2dee379d401669de0f}{amvp\-\_\-set\-\_\-path\-\_\-segment()} specifies the U\-R\-I prefix used by the A\-M\-V\-P server. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_ae188fd1b59bd531853be238e1c0f0b8e}{amvp\-\_\-set\-\_\-cacerts} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, char $\ast$ca\-\_\-file)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_ae188fd1b59bd531853be238e1c0f0b8e}{amvp\-\_\-set\-\_\-cacerts()} specifies P\-E\-M encoded certificates to use as the root trust anchors for establishing the T\-L\-S session with the A\-M\-V\-P server. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_a09996f1527ed324102d6e88bd90044d2}{amvp\-\_\-set\-\_\-certkey} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, char $\ast$cert\-\_\-file, char $\ast$key\-\_\-file)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a09996f1527ed324102d6e88bd90044d2}{amvp\-\_\-set\-\_\-certkey()} specifies P\-E\-M encoded certificate and private key to use for establishing the T\-L\-S session with the A\-M\-V\-P server. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_a251cfd0283bf43677c5212f9ce7c073a}{amvp\-\_\-register} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_a251cfd0283bf43677c5212f9ce7c073a}{amvp\-\_\-register()} registers the D\-U\-T with the A\-M\-V\-P server. \end{DoxyCompactList}\item 
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} \hyperlink{amvp_8c_ad3c004ce730d82ebe4e257e952de6682}{amvp\-\_\-process\-\_\-tests} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em \hyperlink{amvp_8c_ad3c004ce730d82ebe4e257e952de6682}{amvp\-\_\-process\-\_\-tests()} performs the A\-M\-V\-P testing procedures. \end{DoxyCompactList}\item 
\hypertarget{amvp_8c_ad3b3d1d34f251030eff56be5a4f2bd70}{\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} {\bfseries amvp\-\_\-retry\-\_\-handler} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx, unsigned int retry\-\_\-period)}\label{amvp_8c_ad3b3d1d34f251030eff56be5a4f2bd70}

\item 
\hypertarget{amvp_8c_afc137291ba6212077d5af18b4d7c7d76}{\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} {\bfseries amvp\-\_\-check\-\_\-test\-\_\-results} (\hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$ctx)}\label{amvp_8c_afc137291ba6212077d5af18b4d7c7d76}

\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{amvp_8c_adf1492c74212decfe7f97dcee79d313c}{\hyperlink{structamvp__module__test__handler__t}{A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-H\-A\-N\-D\-L\-E\-R} {\bfseries module\-\_\-test\-\_\-tbl} \mbox{[}$\,$\mbox{]}}\label{amvp_8c_adf1492c74212decfe7f97dcee79d313c}

\item 
const int {\bfseries A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-X}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{amvp_8c_af628c1972cfa1f74d56be6f4f5115baf}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-create\-\_\-test\-\_\-session@{amvp\-\_\-create\-\_\-test\-\_\-session}}
\index{amvp\-\_\-create\-\_\-test\-\_\-session@{amvp\-\_\-create\-\_\-test\-\_\-session}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-create\-\_\-test\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-create\-\_\-test\-\_\-session (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$$\ast$}]{ctx, }
\item[{{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T}($\ast$)(char $\ast$msg)}]{progress\-\_\-cb}
\end{DoxyParamCaption}
)}}\label{amvp_8c_af628c1972cfa1f74d56be6f4f5115baf}


\hyperlink{amvp_8c_af628c1972cfa1f74d56be6f4f5115baf}{amvp\-\_\-create\-\_\-test\-\_\-session()} creates a context that can be used to commence a test session with an A\-M\-V\-P server. 

This function should be called first to create a context that is used to manage all the A\-P\-I calls into libamvp. The context should be released after the test session has completed by invoking \hyperlink{amvp_8c_a1cfaae59ace172c0698dddcc5146c2a6}{amvp\-\_\-free\-\_\-test\-\_\-session()}.

When creating a new test session, a function pointer can be provided to receive logging messages from libamvp. The application can then forward the log messages to any logging service it desires, such as syslog.


\begin{DoxyParams}{Parameters}
{\em ctx} & Address of pointer to unallocated \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X}. \\
\hline
{\em progress\-\_\-cb} & Address of function to receive log messages from libamvp.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_aeb93f9081b6a5ead8747d25ebd7d59ce}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-does\-\_\-not\-\_\-apply@{amvp\-\_\-does\-\_\-not\-\_\-apply}}
\index{amvp\-\_\-does\-\_\-not\-\_\-apply@{amvp\-\_\-does\-\_\-not\-\_\-apply}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-does\-\_\-not\-\_\-apply}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-does\-\_\-not\-\_\-apply (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} $\ast$}]{tc, }
\item[{const char $\ast$}]{info}
\end{DoxyParamCaption}
)}}\label{amvp_8c_aeb93f9081b6a5ead8747d25ebd7d59ce}


\hyperlink{amvp_8c_aeb93f9081b6a5ead8747d25ebd7d59ce}{amvp\-\_\-does\-\_\-not\-\_\-apply()} Mark this test case as not applicable to the module under test. 


\begin{DoxyParams}{Parameters}
{\em info} & Pointer to a string explaining why the test does not apply. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_a1cfaae59ace172c0698dddcc5146c2a6}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-free\-\_\-test\-\_\-session@{amvp\-\_\-free\-\_\-test\-\_\-session}}
\index{amvp\-\_\-free\-\_\-test\-\_\-session@{amvp\-\_\-free\-\_\-test\-\_\-session}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-free\-\_\-test\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-free\-\_\-test\-\_\-session (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a1cfaae59ace172c0698dddcc5146c2a6}


\hyperlink{amvp_8c_a1cfaae59ace172c0698dddcc5146c2a6}{amvp\-\_\-free\-\_\-test\-\_\-session()} releases the memory associated with an \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X}. 

This function will free an \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X}. Failure to invoke this function will result in a memory leak in the application layer. This function should be invoked after a test session has completed and a reference to the context is no longer needed.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_aef9e6d5bd96d7f7a5355fa240147ad20}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-lookup\-\_\-test\-\_\-name@{amvp\-\_\-lookup\-\_\-test\-\_\-name}}
\index{amvp\-\_\-lookup\-\_\-test\-\_\-name@{amvp\-\_\-lookup\-\_\-test\-\_\-name}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-lookup\-\_\-test\-\_\-name}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ amvp\-\_\-lookup\-\_\-test\-\_\-name (
\begin{DoxyParamCaption}
\item[{A\-M\-V\-P\-\_\-\-T\-E\-S\-T}]{test\-\_\-type}
\end{DoxyParamCaption}
)}}\label{amvp_8c_aef9e6d5bd96d7f7a5355fa240147ad20}


\hyperlink{amvp_8c_aef9e6d5bd96d7f7a5355fa240147ad20}{amvp\-\_\-lookup\-\_\-test\-\_\-name()} return an ascii string for a particular test. String is a const char and does not need to be freed. 


\begin{DoxyParams}{Parameters}
{\em test\-\_\-type} & A\-M\-V\-P\-\_\-\-T\-E\-S\-T enum value. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
const char $\ast$ 
\end{DoxyReturn}
\hypertarget{amvp_8c_a3cfaee665578de7d947c74023e7d757f}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-lookup\-\_\-test\-\_\-type@{amvp\-\_\-lookup\-\_\-test\-\_\-type}}
\index{amvp\-\_\-lookup\-\_\-test\-\_\-type@{amvp\-\_\-lookup\-\_\-test\-\_\-type}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-lookup\-\_\-test\-\_\-type}]{\setlength{\rightskip}{0pt plus 5cm}A\-M\-V\-P\-\_\-\-T\-E\-S\-T amvp\-\_\-lookup\-\_\-test\-\_\-type (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{test\-\_\-name}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a3cfaee665578de7d947c74023e7d757f}


\hyperlink{amvp_8c_a3cfaee665578de7d947c74023e7d757f}{amvp\-\_\-lookup\-\_\-test\-\_\-type()} return the A\-M\-V\-P\-\_\-\-T\-E\-S\-T enum for a particular test. 


\begin{DoxyParams}{Parameters}
{\em test\-\_\-name} & char $\ast$ pointing to the name of the test. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A\-M\-V\-P\-\_\-\-T\-E\-S\-T 
\end{DoxyReturn}
\hypertarget{amvp_8c_a900277f56b43928cf0872a80bdf2a116}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-not\-\_\-implemented@{amvp\-\_\-not\-\_\-implemented}}
\index{amvp\-\_\-not\-\_\-implemented@{amvp\-\_\-not\-\_\-implemented}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-not\-\_\-implemented}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-not\-\_\-implemented (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} $\ast$}]{tc}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a900277f56b43928cf0872a80bdf2a116}


\hyperlink{amvp_8c_a900277f56b43928cf0872a80bdf2a116}{amvp\-\_\-not\-\_\-implemented()} Mark this test case as not implemented. 


\begin{DoxyParams}{Parameters}
{\em tc} & Pointer the the A\-M\-V\-P\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_ad3c004ce730d82ebe4e257e952de6682}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-process\-\_\-tests@{amvp\-\_\-process\-\_\-tests}}
\index{amvp\-\_\-process\-\_\-tests@{amvp\-\_\-process\-\_\-tests}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-process\-\_\-tests}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-process\-\_\-tests (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx}
\end{DoxyParamCaption}
)}}\label{amvp_8c_ad3c004ce730d82ebe4e257e952de6682}


\hyperlink{amvp_8c_ad3c004ce730d82ebe4e257e952de6682}{amvp\-\_\-process\-\_\-tests()} performs the A\-M\-V\-P testing procedures. 

This function will commence the test session after the D\-U\-T has been registered with the A\-M\-V\-P server. This function should be invoked after \hyperlink{amvp_8c_a251cfd0283bf43677c5212f9ce7c073a}{amvp\-\_\-register()} finishes. When invoked, this function will download the vector sets from the A\-M\-V\-P server, process the vectors, and upload the results to the server.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_a251cfd0283bf43677c5212f9ce7c073a}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-register@{amvp\-\_\-register}}
\index{amvp\-\_\-register@{amvp\-\_\-register}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-register}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-register (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a251cfd0283bf43677c5212f9ce7c073a}


\hyperlink{amvp_8c_a251cfd0283bf43677c5212f9ce7c073a}{amvp\-\_\-register()} registers the D\-U\-T with the A\-M\-V\-P server. 

This function is used to regitser the D\-U\-T with the server. Registration allows the D\-U\-T to advertise it's capabilities to the server. The server will respond with a set of vector set identifiers that the client will need to process.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_ae188fd1b59bd531853be238e1c0f0b8e}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-set\-\_\-cacerts@{amvp\-\_\-set\-\_\-cacerts}}
\index{amvp\-\_\-set\-\_\-cacerts@{amvp\-\_\-set\-\_\-cacerts}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-set\-\_\-cacerts}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-set\-\_\-cacerts (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx, }
\item[{char $\ast$}]{ca\-\_\-file}
\end{DoxyParamCaption}
)}}\label{amvp_8c_ae188fd1b59bd531853be238e1c0f0b8e}


\hyperlink{amvp_8c_ae188fd1b59bd531853be238e1c0f0b8e}{amvp\-\_\-set\-\_\-cacerts()} specifies P\-E\-M encoded certificates to use as the root trust anchors for establishing the T\-L\-S session with the A\-M\-V\-P server. 

A\-M\-V\-P uses T\-L\-S as the transport. In order to verify the identity of the A\-M\-V\-P server, the T\-L\-S stack requires one or more root certificates that can be used to verify the identify of the A\-M\-V\-P T\-L\-S certificate during the T\-L\-S handshake. These root certificates are set using this function. They must be P\-E\-M encoded and all contained in the same file.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session. \\
\hline
{\em ca\-\_\-file} & Name of file containing all the P\-E\-M encoded X.\-509 certificates used as trust anchors for the T\-L\-S session.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_a09996f1527ed324102d6e88bd90044d2}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-set\-\_\-certkey@{amvp\-\_\-set\-\_\-certkey}}
\index{amvp\-\_\-set\-\_\-certkey@{amvp\-\_\-set\-\_\-certkey}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-set\-\_\-certkey}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-set\-\_\-certkey (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx, }
\item[{char $\ast$}]{cert\-\_\-file, }
\item[{char $\ast$}]{key\-\_\-file}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a09996f1527ed324102d6e88bd90044d2}


\hyperlink{amvp_8c_a09996f1527ed324102d6e88bd90044d2}{amvp\-\_\-set\-\_\-certkey()} specifies P\-E\-M encoded certificate and private key to use for establishing the T\-L\-S session with the A\-M\-V\-P server. 

A\-M\-V\-P uses T\-L\-S as the transport. In order for the A\-M\-V\-P server to verify the identity the D\-U\-T using libamvp, a certificate needs to be presented during the T\-L\-S handshake. The certificate used by libamvp needs to be trusted by the A\-M\-V\-P server. Otherwise the T\-L\-S handshake will fail.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session. \\
\hline
{\em cert\-\_\-file} & Name of file containing the P\-E\-M encoded X.\-509 certificate to use as the client identity. \\
\hline
{\em key\-\_\-file} & Name of file containing P\-E\-M encoded private key associated with the client certificate.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_a6c369c4e6f0e27051607e5bc00ea37cb}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-set\-\_\-module\-\_\-info@{amvp\-\_\-set\-\_\-module\-\_\-info}}
\index{amvp\-\_\-set\-\_\-module\-\_\-info@{amvp\-\_\-set\-\_\-module\-\_\-info}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-set\-\_\-module\-\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-set\-\_\-module\-\_\-info (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx, }
\item[{const char $\ast$}]{module\-\_\-name, }
\item[{const char $\ast$}]{module\-\_\-type, }
\item[{const char $\ast$}]{module\-\_\-version, }
\item[{const char $\ast$}]{module\-\_\-description}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a6c369c4e6f0e27051607e5bc00ea37cb}


\hyperlink{amvp_8c_a6c369c4e6f0e27051607e5bc00ea37cb}{amvp\-\_\-set\-\_\-module\-\_\-info()} specifies the crypto module attributes for the test session. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session. \\
\hline
{\em module\-\_\-name} & Name of the crypto module under test. \\
\hline
{\em module\-\_\-type} & The crypto module type\-: software, hardware, or hybrid. \\
\hline
{\em module\-\_\-version} & The version\# of the crypto module under test. \\
\hline
{\em module\-\_\-description} & A brief description of the crypto module under test.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_ab2cc508cf1e3ec2dee379d401669de0f}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-set\-\_\-path\-\_\-segment@{amvp\-\_\-set\-\_\-path\-\_\-segment}}
\index{amvp\-\_\-set\-\_\-path\-\_\-segment@{amvp\-\_\-set\-\_\-path\-\_\-segment}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-set\-\_\-path\-\_\-segment}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-set\-\_\-path\-\_\-segment (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx, }
\item[{char $\ast$}]{path\-\_\-segment}
\end{DoxyParamCaption}
)}}\label{amvp_8c_ab2cc508cf1e3ec2dee379d401669de0f}


\hyperlink{amvp_8c_ab2cc508cf1e3ec2dee379d401669de0f}{amvp\-\_\-set\-\_\-path\-\_\-segment()} specifies the U\-R\-I prefix used by the A\-M\-V\-P server. 

Some A\-M\-V\-P servers use a prefix in the U\-R\-I for the path to the A\-M\-V\-P R\-E\-S\-T interface. Calling this function allows the path segment prefix to be specified. The value provided to this function is prepended to the path segment of the U\-R\-I used for the A\-M\-V\-P R\-E\-S\-T calls.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session. \\
\hline
{\em path\-\_\-segment} & Value to embed in the U\-R\-I path after the server name and before the A\-M\-V\-P well-\/known path.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_a52516e04dceec62a7def9443dd28271e}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-set\-\_\-server@{amvp\-\_\-set\-\_\-server}}
\index{amvp\-\_\-set\-\_\-server@{amvp\-\_\-set\-\_\-server}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-set\-\_\-server}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-set\-\_\-server (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx, }
\item[{char $\ast$}]{server\-\_\-name, }
\item[{int}]{port}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a52516e04dceec62a7def9443dd28271e}


\hyperlink{amvp_8c_a52516e04dceec62a7def9443dd28271e}{amvp\-\_\-set\-\_\-server()} specifies the A\-M\-V\-P server and T\-C\-P port number to use when contacting the server. 

This function is used to specify the hostname or I\-P address of the A\-M\-V\-P server. The T\-C\-P port number can also be specified if the server doesn't use port 443.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session. \\
\hline
{\em server\-\_\-name} & Name or I\-P address of the A\-M\-V\-P server. \\
\hline
{\em port} & T\-C\-P port number the server listens on.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}
\hypertarget{amvp_8c_a3e2e0a8e39f1a1022dcdde62a4669a66}{\index{amvp.\-c@{amvp.\-c}!amvp\-\_\-set\-\_\-vendor\-\_\-info@{amvp\-\_\-set\-\_\-vendor\-\_\-info}}
\index{amvp\-\_\-set\-\_\-vendor\-\_\-info@{amvp\-\_\-set\-\_\-vendor\-\_\-info}!amvp.c@{amvp.\-c}}
\subsubsection[{amvp\-\_\-set\-\_\-vendor\-\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}{\bf A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} amvp\-\_\-set\-\_\-vendor\-\_\-info (
\begin{DoxyParamCaption}
\item[{{\bf A\-M\-V\-P\-\_\-\-C\-T\-X} $\ast$}]{ctx, }
\item[{const char $\ast$}]{vendor\-\_\-name, }
\item[{const char $\ast$}]{vendor\-\_\-url, }
\item[{const char $\ast$}]{contact\-\_\-name, }
\item[{const char $\ast$}]{contact\-\_\-email}
\end{DoxyParamCaption}
)}}\label{amvp_8c_a3e2e0a8e39f1a1022dcdde62a4669a66}


\hyperlink{amvp_8c_a3e2e0a8e39f1a1022dcdde62a4669a66}{amvp\-\_\-set\-\_\-vendor\-\_\-info()} specifies the vendor attributes for the test session. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to \hyperlink{structAMVP__CTX}{A\-M\-V\-P\-\_\-\-C\-T\-X} that was previously created by calling amvp\-\_\-create\-\_\-test\-\_\-session. \\
\hline
{\em vendor\-\_\-name} & Name of the vendor that owns the crypto module. \\
\hline
{\em vendor\-\_\-url} & The Vendor's U\-R\-L. \\
\hline
{\em contact\-\_\-name} & Name of contact at Vendor. \\
\hline
{\em contact\-\_\-email} & Email of vendor contact.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structAMVP__RESULT}{A\-M\-V\-P\-\_\-\-R\-E\-S\-U\-L\-T} 
\end{DoxyReturn}


\subsection{Variable Documentation}
\hypertarget{amvp_8c_a5de7a6cbd2c4fb0f32e57e62e740c7e3}{\index{amvp.\-c@{amvp.\-c}!A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-X@{A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-X}}
\index{A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-X@{A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-X}!amvp.c@{amvp.\-c}}
\subsubsection[{A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-X}]{\setlength{\rightskip}{0pt plus 5cm}const int A\-M\-V\-P\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-T\-E\-S\-T\-\_\-\-M\-A\-X}}\label{amvp_8c_a5de7a6cbd2c4fb0f32e57e62e740c7e3}
{\bfseries Initial value\-:}
\begin{DoxyCode}
= 
        \textcolor{keyword}{sizeof}(module\_test\_tbl)/\textcolor{keyword}{sizeof}(module\_test\_tbl[0])
\end{DoxyCode}
